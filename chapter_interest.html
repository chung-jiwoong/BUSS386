<!DOCTYPE html>
<html lang="en"><head>
<script src="chapter_interest_files/libs/clipboard/clipboard.min.js"></script>
<script src="chapter_interest_files/libs/quarto-html/tabby.min.js"></script>
<script src="chapter_interest_files/libs/quarto-html/popper.min.js"></script>
<script src="chapter_interest_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="chapter_interest_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="chapter_interest_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="chapter_interest_files/libs/quarto-html/quarto-syntax-highlighting-48ffa3e5b9d089919c6712c39e5b00f2.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.41">

  <meta name="author" content="Prof.&nbsp;Ji-Woong Chung">
  <title>Interest Rates</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="chapter_interest_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="chapter_interest_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="chapter_interest_files/libs/revealjs/dist/theme/quarto-8f3eebe07241f08526c91a7e9cbef8fd.css">
  <link href="chapter_interest_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="chapter_interest_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="chapter_interest_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="chapter_interest_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="chapter_interest_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="chapter_interest_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Interest Rates</h1>
  <p class="subtitle">BUSS386 Futures and Options</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Prof.&nbsp;Ji-Woong Chung 
</div>
</div>
</div>

</section>
<section id="lecture-outline" class="slide level2">
<h2>Lecture Outline</h2>
<ul>
<li>Interest Rates
<ul>
<li>Types</li>
<li>Measurement</li>
<li>Zero/Spot/Forward rates</li>
<li>Forward Rate Agreements</li>
<li>Duration and convexity</li>
</ul></li>
<li>Reading: § Ch. 4</li>
</ul>
</section>
<section>
<section id="interest-rates-types-and-measurement" class="title-slide slide level1 center">
<h1>Interest Rates: Types and Measurement</h1>

</section>
<section id="interest-rates" class="slide level2">
<h2>Interest Rates</h2>
<ul>
<li>For valuation of derivatives (and any financial asset), we need interest rates.</li>
<li>There are different types and measurements of the interest rates.</li>
<li>In general, interest rates are higher for riskier investments.
<ul>
<li><strong>Risk-free interest rate</strong> is the rate for investment having zero risk.</li>
</ul></li>
</ul>
</section>
<section id="types-of-interest-rates" class="slide level2 scrollable">
<h2>Types of Interest Rates</h2>
<ul>
<li>Treasury Rates
<ul>
<li>The rate earned by investors when they invest in government (treasury) bonds.</li>
<li>Governments are generally able to repay the principal and interest, making these bonds nearly risk-free (hence, they are often considered risk-free rates).<sup>1</sup></li>
</ul></li>
<li>Overnight Rates
<ul>
<li>Banks must maintain a certain amount of cash, known as a reserve, with the central bank.</li>
<li>They borrow and lend overnight to manage these reserves.</li>
<li>Examples include the Federal funds rate (U.S.), SONIA (U.K.), ESTER (Euro), SARON (Swiss), and TONAR (Japan).</li>
</ul></li>
<li>Repo Rates
<ul>
<li>Unlike overnight rates, repo rates are for secured borrowing.</li>
<li>Examples include SOFR (U.S.) and KOFR (Korea).</li>
</ul></li>
</ul>
<aside><ol class="aside-footnotes"><li id="fn1"><p>Read: <a href="https://en.wikipedia.org/wiki/Default_trap?utm_source=chatgpt.com">Default Trap</a></p></li></ol></aside></section>
<section id="reference-rates" class="slide level2">
<h2>Reference Rates</h2>
<ul>
<li>Reference interest rates play a crucial role in financial markets.</li>
<li>LIBOR (London Interbank Offered Rate):
<ul>
<li>Represents the rate at which banks can borrow from other banks.</li>
<li>Only banks with high creditworthiness (e.g., a credit rating of AA or higher) can borrow at LIBOR.</li>
<li>This rate is for unsecured loans, meaning there is a theoretical risk of default by the borrowing bank.</li>
<li>However, the risk of default is minimal because banks in the LIBOR market have high credit ratings, making it an almost risk-free rate.</li>
</ul></li>
</ul>
</section>
<section id="libor-phase-out" class="slide level2 scrollable">
<h2>LIBOR Phase-out</h2>
<ul>
<li>The LIBOR Scandal in 2012<sup>1</sup></li>
<li>Regulators phased out LIBOR by the end of 2021, replacing it with new reference rates based on actual overnight market transactions.</li>
<li>New reference rates (based on repo rates where indicated):
<ul>
<li>US dollar: SOFR (Secured Overnight Financing Rate)*</li>
<li>Korea: KOFR (Korea Overnight Financing Repo Rate)*</li>
<li>GBP: SONIA (Sterling Overnight Index Average)</li>
<li>EU: ESTER (Euro Short-Term Rate)</li>
<li>Switzerland: SARON (Swiss Average Overnight Rate)</li>
<li>Japan: TONAR (Tokyo Overnight Average Rate)</li>
</ul></li>
</ul>
<aside><ol class="aside-footnotes"><li id="fn2"><p>Read: <a href="https://en.wikipedia.org/wiki/Libor_scandal">Libor scandal</a></p></li></ol></aside></section>
<section id="section" class="slide level2">
<h2></h2>

<img data-src="../img/interest_libor.png" class="quarto-figure quarto-figure-center r-stretch"><p>Source: <a href="https://www.bis.org/publ/qtrpdf/r_qt2212e.htm">https://www.bis.org/publ/qtrpdf/r_qt2212e.htm</a></p>
</section>
<section id="measuring-interest-rates" class="slide level2">
<h2>Measuring Interest Rates</h2>
<ul>
<li>Interest rates are quoted as an <strong>annual</strong> rate.</li>
<li>However, the actual frequency at which interests are earned (or compounded) does not have to be annual
<ul>
<li>semiannual compounding: interests are earned in every six months.</li>
<li>quarterly compounding: interests are earned in every quarter.</li>
<li>monthly compounding: interests are earned in every month.</li>
<li>⋮</li>
</ul></li>
<li>Let <span class="math inline">\(r\)</span> denote the annual rate and <span class="math inline">\(m\)</span> denote the number of compounding periods in a year. If you invest $1 for one year, then future value is <span class="math display">\[
\$1\times\left( 1 + \frac{r}{m} \right)^m
\]</span></li>
</ul>
</section>
<section id="measuring-interest-rates-1" class="slide level2">
<h2>Measuring Interest Rates</h2>
<ul>
<li><strong>Continuous compounding</strong> is an extreme case where interests are earned at every instant.</li>
<li>With the annual rate <span class="math inline">\(r\)</span>, the future value of $1 after one year with continuous compounding is <span class="math display">\[
\$1\times e^{r}
\]</span></li>
<li>The future value after <span class="math inline">\(T\)</span> years is <span class="math display">\[
\$1\times e^{rT}
\]</span></li>
</ul>
</section>
<section id="conversion-of-interest-rates" class="slide level2">
<h2>Conversion of Interest Rates</h2>
<ul>
<li>In some cases, we need to convert the interest rate with continuous compounding to the rate with different compounding frequency (or vice versa).</li>
<li>Let <span class="math inline">\(r_c\)</span> denote the rate with continuous compounding. Also, let <span class="math inline">\(r_m\)</span> denote the rate with compounding <span class="math inline">\(m\)</span> times per year. Then, <span class="math display">\[
e^{r_c} =\left( 1+ \frac{r_m}{m} \right)^m
\]</span></li>
<li><strong>Example:</strong> An interest rate is quoted as 10% per annum with semiannual compounding. What is the equivalent rate with continuous compounding? Higher or lower?</li>
<li><strong>Note:</strong> Given <span class="math inline">\(P_{t+1}\)</span> and <span class="math inline">\(P_t\)</span>, <span class="math inline">\(r_c =\ln\frac{P_{t+1}}{P_t}\)</span>. That is, <span class="math inline">\(P_{t+1}=e^{r_C}P_t\)</span>.</li>
</ul>
</section>
<section id="zero-rates" class="slide level2">
<h2>Zero Rates</h2>
<ul>
<li>Consider a risk-free zero-coupon bond where all principal and interests are paid at the end of <span class="math inline">\(n\)</span> years.</li>
<li>The interest rate on such investment is called <span class="math inline">\(n\)</span>-year zero-coupon interest rate (in short, we also call <span class="math inline">\(n\)</span>-year zero rate or <span class="math inline">\(n\)</span>-year spot rate).</li>
<li><strong>Example:</strong> 5-year zero-coupon bond with the principal of $1,000 is priced at $890. What is the 5-year zero rate with continuous compounding?
<ul>
<li>Solving for <span class="math inline">\(r\)</span> such that <span class="math inline">\(890\times e^{r5}=1000\)</span>, <span class="math inline">\(r\)</span>=2.33%.</li>
</ul></li>
</ul>
</section>
<section id="zero-rates---facts-i" class="slide level2">
<h2>Zero Rates - Facts I</h2>
<ul>
<li>Zero rates vary by maturity, forming the <strong>term structure</strong> of interest rates.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> [1] "DGS1MO" "DGS3MO" "DGS6MO" "DGS1"   "DGS2"   "DGS3"   "DGS5"   "DGS7"  
 [9] "DGS10"  "DGS20"  "DGS30" </code></pre>
</div>

</div>
<img data-src="chapter_interest_files/figure-revealjs/unnamed-chunk-1-1.png" width="960" class="r-stretch"></section>
<section id="zero-rates---facts-ii" class="slide level2">
<h2>Zero Rates - Facts II</h2>
<ul>
<li>The interest rate for a certain maturity can change over time.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "DGS10"</code></pre>
</div>

</div>
<img data-src="chapter_interest_files/figure-revealjs/unnamed-chunk-2-1.png" width="960" class="r-stretch"></section>
<section id="interest-rates---notation" class="slide level2">
<h2>Interest Rates - Notation</h2>
<ul>
<li>Given the fact that interest rates differ depending on the maturity, we use the following notation: <span class="math display">\[
r_0(t_1,t_2)
\]</span> is the interest rate from <span class="math inline">\(t_1\)</span> to <span class="math inline">\(t_2\)</span> (with continuous compounding).</li>
</ul>
</section>
<section id="bond-pricing" class="slide level2">
<h2>Bond Pricing</h2>
<ul>
<li>A 2-year bond with a principal of $100 provides coupons at the rate of 6% per annum semiannually. The theoretical price of the bond is <span class="math display">\[
3e^{-0.05(0.5)} + 3e^{-0.058(1.0)} + 3e^{-0.064(1.5)} + 103e^{-0.068(2.0)} = 98.39
\]</span></li>
</ul>
<p><strong>Table 4.2 Zero Rates</strong></p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Maturity (years)</th>
<th>Zero rate (% continuously compounded)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0.5</td>
<td>5.0</td>
</tr>
<tr class="even">
<td>1.0</td>
<td>5.8</td>
</tr>
<tr class="odd">
<td>1.5</td>
<td>6.4</td>
</tr>
<tr class="even">
<td>2.0</td>
<td>6.8</td>
</tr>
</tbody>
</table>
<ul>
<li>A <strong>yield-to-maturity</strong> is the single discount rate that gives a bond price equal to its market price (<span class="math inline">\(y=6.76\%\)</span>) <span class="math display">\[
3e^{-y(0.5)} + 3e^{-y(1.0)} + 3e^{-y(1.5)} + 103e^{-y(2.0)} = 98.39
\]</span></li>
</ul>
</section>
<section id="bond-pricing-1" class="slide level2">
<h2>Bond Pricing</h2>
<ul>
<li><p>The par yield for a certain bond maturity is the coupon rate that makes the bond price equal its par value.</p></li>
<li><p>Suppose that the coupon on a 2-year bond is <span class="math inline">\(c\)</span> per annum. Using the zero rates in Table 4.2, the value of the bond is equal to its par value of 100 when <span class="math inline">\(c=6.87\%\)</span>. <span class="math display">\[
\frac{c}{2}e^{-0.05(0.5)} + \frac{c}{2}e^{-0.058(1.0)} + \frac{c}{2}e^{-0.064(1.5)} + \left(100+\frac{c}{2}\right)e^{-0.068(2.0)} = 100
\]</span></p></li>
<li><p>Useful for benchmarking and pricing: Can compare bonds with different coupon rates.</p></li>
</ul>
</section>
<section id="forward-rates" class="slide level2">
<h2>Forward Rates</h2>
<ul>
<li><p><strong>Example:</strong> Consider the following term-structure of interest rates:</p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Maturity (years)</th>
<th>Interest rate (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>3.0</td>
</tr>
<tr class="even">
<td>2</td>
<td>4.0</td>
</tr>
</tbody>
</table></li>
<li><p>We can find the <strong>implicit</strong> rate that can be earned from year 1 to year 2. Let <span class="math inline">\(r\)</span> denote the rate. Then, <span class="math display">\[
e^{0.04\times 2} = e^{0.03}e^r
\]</span> <span class="math inline">\(r\)</span> = 5.00%.</p></li>
<li><p>We call <span class="math inline">\(r\)</span> the <strong>(implied) forward rate</strong>.</p></li>
</ul>
</section>
<section id="forward-rates---borrowinglending" class="slide level2">
<h2>Forward Rates - Borrowing/Lending</h2>
<ul>
<li><p>We can lock in interests for future borrowing/lending at this forward rate.</p></li>
<li><p>Suppose that we want to borrow $1 one year from now and repay in year 2. Also, we want to fix now the interest rate for this borrowing.</p></li>
<li><p>If we fix at the forward rate, this borrowing will have cash flows as follows:</p>
<table class="caption-top">
<colgroup>
<col style="width: 50%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th>Action</th>
<th>year 0</th>
<th>year 1</th>
<th>year 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>borrowing at forward rate</td>
<td>0</td>
<td>1</td>
<td><span class="math inline">\(-e^{0.05\times 1}\)</span></td>
</tr>
</tbody>
</table></li>
</ul>
</section>
<section id="forward-rates---borrowinglending-1" class="slide level2">
<h2>Forward Rates - Borrowing/Lending</h2>
<ul>
<li><p>We may not have a financial instrument where we can borrow or lend at the forward rate in the markets.</p></li>
<li><p>Then, we can construct this by combining two zero coupon bonds. In this construction, we can choose the face-value of zero coupon bonds as we like.</p>
<table class="caption-top">
<colgroup>
<col style="width: 34%">
<col style="width: 20%">
<col style="width: 8%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th>Action</th>
<th>year 0</th>
<th>year 1</th>
<th>year 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>buy 1-yr bond (lend)</td>
<td><span class="math inline">\(-e^{-0.03\times 1}\)</span></td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td>sell 2-yr bond (borrow)</td>
<td><span class="math inline">\(e^{-0.03\times 1}\)</span></td>
<td>0</td>
<td><span class="math inline">\(-e^{-0.03\times 1}e^{0.04\times 2}\)</span></td>
</tr>
<tr class="odd">
<td>net</td>
<td>0</td>
<td>1</td>
<td><span class="math inline">\(-e^{0.05\times 1}\)</span></td>
</tr>
</tbody>
</table></li>
</ul>
</section>
<section id="forward-rates---notation" class="slide level2">
<h2>Forward Rates - Notation</h2>
<ul>
<li>In the forward rate, the time of measuring interest rate is different from the starting time of investment.</li>
<li>Thus, we generalize the notation for interest rate: <span class="math display">\[
r_t(t_1,t_2)
\]</span> is the interest rate from time <span class="math inline">\(t_1\)</span> to <span class="math inline">\(t_2\)</span>, measured on date <span class="math inline">\(t\)</span>.</li>
</ul>
</section>
<section id="forward-rates---example" class="slide level2">
<h2>Forward Rates - Example</h2>
<ul>
<li><p><strong>Example:</strong> Consider the following term-structure of interest rates:</p>
<table class="caption-top">
<thead>
<tr class="header">
<th>Maturity (years)</th>
<th>Interest rate (%)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>3.0</td>
</tr>
<tr class="even">
<td>2</td>
<td>4.0</td>
</tr>
<tr class="odd">
<td>3</td>
<td>4.6</td>
</tr>
</tbody>
</table></li>
<li><p><strong>Q1:</strong> What is the implied forward rate <span class="math inline">\(r_0(2,3)\)</span>?</p></li>
</ul>
</section>
<section id="forward-rates---borrowinglending---example" class="slide level2">
<h2>Forward Rates - Borrowing/Lending - Example</h2>
<ul>
<li><strong>Q2:</strong> An investor wants to lend $100 in year 2 and receive in year 3. The investor wants to lock in the interest rate at <span class="math inline">\(r_0(2,3)\)</span>. Construct this instrument using two zero bonds.</li>
</ul>
</section>
<section id="forward-rate-agreements" class="slide level2">
<h2>Forward Rate Agreements</h2>
<ul>
<li><p>A forward rate agreement (FRA) is an agreement to exchange a predetermined fixed rate for a reference rate that will be observed in the market at a future time (the principal itself is not exchanged).</p></li>
<li><p>Consider an agreement to exchange 3% for three-month LIBOR in two years with both rates being applied to a principal of $100 million. Party A (B) would agree to pay (receive) LIBOR and receive (pay) the fixed rate of 3%. Assume all rates are compounded quarterly. If three-month LIBOR proved to be 3.5% in two years, Party B would receive <span class="math display">\[
\$100,000,000 \times (0.035 - 0.030) \times 0.25 = \$125,000
\]</span></p></li>
<li><p>As LIBOR is phased out, we can expect to see more FRAs based on floating rates such as three-month SOFR and three-month SONIA.</p></li>
</ul>
</section>
<section id="forward-rate-agreements-1" class="slide level2">
<h2>Forward Rate Agreements</h2>
<ul>
<li><p>At initiation, an FRA rate is set so as to have zero value. That is, the FRA rate = forward rate.</p></li>
<li><p>As time passes, the forward rate is likely to change. The FRA value deviates from zero.</p>
<ul>
<li><strong>Example:</strong> forward SOFR rate for the period between time 1.5 years and time 2 years in the future is 5% (with semiannual compounding)</li>
<li>Some time ago a company entered into an FRA where it will receive 5.8% (with semiannual compounding) and pay SOFR on a principal of $100 million for the period.</li>
<li>The 2-year (SOFR) risk-free rate is 4% (with continuous compounding).</li>
<li>The value of the FRA is <span class="math display">\[
\$100,000,000 \times \frac{(0.058 - 0.050)}{2} \times e^{-0.04(2)} = \$369,200
\]</span></li>
</ul></li>
</ul>
<!-- LIBOR phase out and FRA @ https://www.bis.org/publ/qtrpdf/r_qt2212e.htm -->
</section></section>
<section>
<section id="interest-rate-risk-measurement-and-management" class="title-slide slide level1 center">
<h1>Interest Rate Risk: Measurement and Management</h1>

</section>
<section id="interest-rate-risk" class="slide level2">
<h2>Interest Rate Risk</h2>
<ul>
<li>Interest rate or yield volatility translates into price volatility for fixed income securities.</li>
<li>Financial institutions like commercial and investment banks, and fixed income portfolio managers, are highly exposed to interest rate volatility</li>
<li>These institutions manage interest rate risk in a variety of ways that include forward, future and swap contracts, and dynamic hedging strategies</li>
</ul>
</section>
<section id="duration-and-convexity" class="slide level2">
<h2>Duration and Convexity</h2>
<ul>
<li>A security’s price is function of its yield “y” and other factors: $ p(y; others)$:
<ul>
<li>Other factors include maturity, coupon, embedded options, default risk, market conditions, etc.</li>
</ul></li>
<li>Consider a bond with cash flows <span class="math inline">\(K_{i}\)</span> (coupon + par value) at time <span class="math inline">\(t_i \in \{t_1, t_2, ..., t_N \}\)</span>.
<ul>
<li><span class="math inline">\(P_0 = \sum_{i=1}^{N} K_i e^{-y_c t_i}\)</span>, when <span class="math inline">\(y_c\)</span> is quoted as continuously compounded.</li>
<li><span class="math inline">\(P_0= \sum_{i=1}^{N} K_i (1+y_m/m)^{-mt_i}\)</span> when <span class="math inline">\(y_m\)</span> is quoted as compounded <span class="math inline">\(m\)</span> times per year.</li>
</ul></li>
<li>Duration measures are related to the first partial derivative: <span class="math inline">\(\partial P / \partial y\)</span></li>
<li>Convexity measures are related to the second derivative: $ ^2 P / y^2$</li>
</ul>
</section>
<section id="duration-basics" class="slide level2">
<h2>Duration: Basics</h2>
<ul>
<li>Duration measures the first order bond price sensitivity to interest rate changes.
<ul>
<li>Higher duration means higher price sensitivity to interest rate changes (more price volatility).</li>
<li>More precisely, it is the elasticity of a bond price with respect to its yield</li>
</ul></li>
<li>Macaulay duration: % change in <span class="math inline">\(P\)</span> w.r.t % change in <span class="math inline">\(y\)</span>. <span class="math display">\[
D_{Mac} = -\frac{dP/P}{dy/(1+y/m)} = -\frac{dP/P}{dy} (1+y/m)
\]</span></li>
<li>Based on the promised cash flows. As such, it is only accurate for risk-free bonds with no embedded options.</li>
<li>Duration is a property of a security or a portfolio at a point in time. It changes over time.</li>
</ul>
</section>
<section id="duration-basics-1" class="slide level2 scrollable">
<h2>Duration: Basics</h2>
<ul>
<li>The formula for Macaulay duration is: <span class="math display">\[
D_{Mac} = \sum_{i=1}^{N} t_i \left( \frac{ K_i e^{-y_c t_i}}{P}  \right) (1+y_c/ m)
\]</span> <span class="math display">\[
D_{Mac} = \sum_{i=1}^{N} t_i \left( \frac{K_i \left( 1+ y_m/m \right)^{-mt_i}}{P} \right)
\]</span></li>
<li>Macaulay duration is a weighted average of arrival time of cash flows, where the weights are the fraction of present value represented by that cash flow.
<ol type="1">
<li>Macaulay duration of an option-free coupon bond is less than or equal to its time to maturity</li>
<li>Macaulay duration of a zero coupon option-free bond is equal to its time to maturity</li>
<li>The higher the coupon rate the shorter the duration</li>
<li>As market yield increases, duration decreases</li>
</ol></li>
</ul>
</section>
<section id="modified-duration" class="slide level2">
<h2>Modified Duration</h2>
<ul>
<li>Modified duration: <span class="math inline">\(D = D_{Mod} = D_{Mac}/(1+y/m)\)</span>
<ul>
<li><span class="math inline">\(D_{Mod} =\sum_{i=1}^{N} t_i \left( \frac{ K_i e^{-y_c t_i}}{P}  \right)\)</span> with <span class="math inline">\(y_c\)</span>.</li>
<li><span class="math inline">\(D_{Mod}= \sum_{i=1}^{N} t_i \left( \frac{ K_i \left( 1+y_m/m \right)^{-mt_i}  }{P} \right) \left( 1+ y_m/m \right)^{-1}\)</span> with <span class="math inline">\(y_m\)</span>.</li>
</ul></li>
<li>Therefore, <span class="math inline">\(D_{Mod} = - \frac{dP/P}{dy}\)</span></li>
<li>Rearranging it: <span class="math inline">\(\frac{dP}{P}  = -D_{Mod}dy\)</span>
<ul>
<li>The percentage price change is approximated by: (modified duration) times (the change in the yield).</li>
<li>However, duration only gives an accurate estimate of price change for small yield changes.</li>
<li>Due to the convexity of the price function.</li>
</ul></li>
</ul>
<table class="caption-top" style="width:6%;">
<colgroup>
<col style="width: 5%">
</colgroup>
<tbody>
<tr class="odd">
<td>## Dollar Duration</td>
</tr>
<tr class="even">
<td>- Dollar duration, <span class="math inline">\(D_d = D_{Mod} \times P = -\frac{dP/P}{dy} \times P = -\frac{dP}{dy}\)</span> - Therefore, <span class="math inline">\(dP = -D_d dy = -D_{Mod} P dy\)</span> - The dollar price change w.r.t. the change in yield. - Dollar duration is useful in hedging strategies and for understanding risk of zero NPV portfolios (e.g.&nbsp;interest rate swap)</td>
</tr>
</tbody>
</table>
</section>
<section id="portfolio-duration" class="slide level2 scrollable">
<h2>Portfolio Duration</h2>
<ol type="1">
<li>The modified duration of a bond portfolio is the value weighted average modified duration of bonds in the portfolio.</li>
<li>The dollar duration of a portfolio is the sum of the dollar durations of the bonds in the portfolio.</li>
</ol>
<ul>
<li>For a zero-value portfolio, only dollar duration is defined.</li>
</ul>
</section>
<section id="effective-duration" class="slide level2">
<h2>Effective Duration</h2>
<ul>
<li>Effective duration</li>
<li>An <em>empirical</em> change in bond price w.r.t change in yield.</li>
<li>For securities with uncertain cash flows due to optionality (like callable bonds, MBS with prepayment options, or securities with credit risk), effective duration can be significantly different from modified (or Macaulay) duration.</li>
<li>The standard duration formulas are inaccurate when cash flows are highly uncertain. In such cases effective duration is the better measure. <span class="math display">\[
D_{eff} = -\frac{1}{P}\frac{dP}{dy} =-\frac{1}{P}\frac{P(+x \; bps) - P(-x \; bps)}{2x}
\]</span></li>
</ul>
</section>
<section id="convexity" class="slide level2">
<h2>Convexity</h2>
<ul>
<li>Convexity is a measure of the curvature of the price-rate curve.</li>
<li>It is used to improve upon duration-based approximations and hedging strategies.</li>
<li>A long position in non-callable bonds always has positive convexity.</li>
<li>All else being equal, positive convexity is a desirable property for a long position; negative convexity is a bad thing.
<ul>
<li>Positive convexity means that duration underestimates the price increase resulting from a drop in yields, and overestimates the price decrease from an increase in yields.</li>
</ul></li>
</ul>
</section>
<section id="convexity-1" class="slide level2">
<h2>Convexity</h2>
<ul>
<li>Convexity is found by taking the second derivative of the bond price function and then dividing by the price <span class="math inline">\(= \frac{1}{P} \frac{d^2 P}{d y^2}\)</span> for an option-free bond:
<ul>
<li><span class="math inline">\(C_{Mod} =\sum_{i=1}^{N} t_i^2  \frac{ K_i  e^{-y_c t_i}}{P}\)</span></li>
<li><span class="math inline">\(C_{Mod} = \sum_{i=1}^{N} t_i \left( t_i + \frac{1}{m} \right)\frac{K_i \left( 1+ y_m/m \right)^{-(mt_i+2)}}{P}\)</span></li>
<li><span class="math inline">\(C_{Mac} = C_{Mod} \times (1+y/m)^2\)</span></li>
<li>Note that convexity is measured in terms of “years squared.” The units have no intuitive interpretation.</li>
<li>Dollar convexity: <span class="math inline">\(C \times P\)</span></li>
</ul></li>
</ul>
</section>
<section id="using-convexity-to-improve-price-sensitivity-estimates" class="slide level2">
<h2>Using Convexity to Improve Price Sensitivity Estimates</h2>
<div class="callout callout-none no-icon callout-style-simple">
<div class="callout-body">
<div class="callout-content">
<p><strong>Taylor series</strong> <span class="math display">\[
f(x)-f(x_0) \approx f'(x_0)(x-x_0) + \frac{1}{2}f''(x_0)(x-x_0)^2
\]</span> <span class="math display">\[
\Rightarrow P(y)-P(y_0) \approx P'(y_0)(y-y_0) + \frac{1}{2}P''(y_0)(y-y_0)^2
\]</span></p>
</div>
</div>
</div>
<ul>
<li><span class="math inline">\(P'(y_0)\)</span>: <span class="math inline">\(-\)</span>Dollar duration, <span class="math inline">\(P''(y_0)\)</span>: Dollar convexity <span class="math display">\[
\Rightarrow \frac{P(y)-P(y_0)}{P(y)}  \approx \frac{P'(y_0)}{P(y)}(y-y_0) + \frac{1}{2}\frac{P''(y_0)}{P(y)}(y-y_0)^2
\]</span></li>
<li>Percent change in price: <span class="math display">\[
\frac{\Delta P}{P} \approx -D \Delta y + \frac{1}{2} C \Delta y^2
\]</span></li>
</ul>
</section>
<section id="hedging-with-duration-and-convexity" class="slide level2">
<h2>Hedging with Duration and Convexity</h2>
<ul>
<li><p>Change in bond price with a change in interest rates: <span class="math display">\[
\Delta P \approx -D P \Delta y + \frac{1}{2} C P \Delta y^2
\]</span></p></li>
<li><p>A delta neutral portfolio equates the hedge ratio (duration) of assets and liabilities.</p></li>
<li><p>A gamma neutral portfolio is delta neutral, and also equates the gammas (convexity) of assets and liabilities.</p></li>
</ul>
</section>
<section id="example" class="slide level2">
<h2>Example</h2>
<ul>
<li><p>A dealer in corporate bonds finds herself with an inventory of $1mm in a 5 year 6.9% bonds (semiannual payments) at the end of the trading day, priced at par.</p></li>
<li><p>The bonds are illiquid, so selling them would entail a loss. Holding them overnight is risky, since their price might fall if rates rise.</p></li>
<li><p>An alternative to selling the corporate bonds is to short more liquid Treasury bonds. The following bonds are available:</p>
<ul>
<li>10 yr, 8% Treasury, <span class="math inline">\(p = \$1,109.0\)</span> per $1,000 face</li>
<li>3 yr, 6.3% Treasury, <span class="math inline">\(p = \$1,008.1\)</span> per $1,000 face</li>
</ul></li>
<li><p>How much of the 10 year bond would she need to short to hedge? How much of the 3 year bond?</p></li>
<li><p>If yields rise by 1% overnight on all the bonds, show the result of the transactions the next day when the short position is closed out.</p></li>
</ul>
</section>
<section id="example-contd" class="slide level2 scrollable">
<h2>Example (cont’d)</h2>
<ol type="1">
<li>Find modified duration of the bond to be hedged
<ul>
<li>For 5 year 6.9% bond: <span class="math inline">\(y = 6.9\%, D=4.1685\)</span></li>
</ul></li>
<li>Find modified duration of the bonds to be shorted (find yields first)
<ul>
<li>For 10 year 8% bond: <span class="math inline">\(y=6.5\%, D=7.004\)</span></li>
<li>For 3 year 6.3% bond: <span class="math inline">\(y = 6.00\%, D = 2.6999\)</span></li>
</ul></li>
<li>Find <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> in:
<ul>
<li>$$1m(4.1688)+x(7.005)=0 x =$595,167 $</li>
<li>$$1m(4.1688)+y(2.7)=0 y = $1,543,947 $</li>
</ul></li>
<li>If yields rise by 1% overnight on all the bonds:
<ul>
<li>For 5 yr, yield to 7.9%,: <span class="math inline">\(P=\$959.423/1,000=0.959423\)</span>, Loss: $($1,000,000)(1-0.959423) = $40,577 $</li>
<li>For 10 year yield to 7.5% <span class="math inline">\(P=\$1034.81/1109=0.93311\)</span>, Loss: <span class="math inline">\((\$595,167)(1-0.93311) = \$39,810\)</span></li>
<li>For 3 year yield to 7%: <span class="math inline">\(P=\$981.42/\$1,008.1=0.97353\)</span>, Loss: $($1,543,947)(1-.97353) = $40,861 $</li>
</ul></li>
</ol>
</section>
<section id="example-contd-1" class="slide level2">
<h2>Example (cont’d)</h2>
<ul>
<li><p>What if the dealer wants the added protection of doing a gamma neutral hedge?</p></li>
<li><p>Investment must be both delta neutral and gamma neutral. This requires matching deltas and gammas, and requires investments in both bonds.</p>
<ul>
<li><span class="math inline">\(P1 = \$1 m, D1 = 4.1685, C1 = 21.036\)</span></li>
<li><span class="math inline">\(P2 = ?, D2 = 7.004, C2 = 62.98\)</span></li>
<li><span class="math inline">\(P3 = ?, D3 = 2.699, C3 = 8.939\)</span></li>
</ul></li>
<li><p>Match hedge ratios:</p>
<ul>
<li>$ $1m(4.1685) = P2(7.004) + P3(2.699)$</li>
</ul></li>
<li><p>Match gamma:</p>
<ul>
<li>$ $1m(21.038) = P2(62.98) + P3(8.939) $</li>
</ul></li>
<li><p>2 linear equations in two unknowns. Solve for P2 and P3.</p></li>
</ul>

</section></section>

    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="chapter_interest_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="chapter_interest_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="chapter_interest_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="chapter_interest_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="chapter_interest_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="chapter_interest_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="chapter_interest_files/libs/revealjs/plugin/reveal-text-resizer/revealjs-text-resizer.js"></script>
  <script src="chapter_interest_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="chapter_interest_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="chapter_interest_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="chapter_interest_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="chapter_interest_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'fast',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, RevealTextResizer, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>